(()=>{"use strict";class e{constructor(e,t,s,n){this._data=e,this._name=e.title,this._link=e.link,this._templateSelector=t,this._openZoomImage=s,this._openDeletePopup=n}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_handleCardClick=()=>{this._openZoomImage(this._data)};_handleLikeImage=()=>{this._elementLike.classList.toggle("element__like_active")};_handleImageDelete=()=>{this._openDeletePopup(this)};removeCard(){this._element.remove(),this._element=null}_setEventListeners(){this._elementImage.addEventListener("click",this._handleCardClick),this._elementLike.addEventListener("click",this._handleLikeImage),this._elementDelete.addEventListener("click",this._handleImageDelete)}generateCard(){return this._element=this._getTemplate(),this._elementImage=this._element.querySelector(".element__image"),this._elementLike=this._element.querySelector(".element__like"),this._elementDelete=this._element.querySelector(".element__delete"),this._setEventListeners(),this._element.querySelector(".element__image").src=this._link,this._element.querySelector(".element__title").textContent=this._name,this._element}}const t=class{constructor(e,t){this._form=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._errorSpan=e.errorSpan,this._savedButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e,t){e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorSpan)}_hideInputError(e,t){e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorSpan)}_checkValidity(e){const t=document.querySelector(`#error-${e.id}`);e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)}_disableButton(){this._savedButton.setAttribute("disabled",""),this._savedButton.classList.add(this._inactiveButtonClass)}_enableButton(){this._savedButton.removeAttribute("disabled"),this._savedButton.classList.remove(this._inactiveButtonClass)}_validityButton(){this._form.checkValidity()?this._enableButton():this._disableButton()}enableValidation(){this._form.addEventListener("submit",(function(e){e.preventDefault()}));const e=this._form.querySelectorAll(this._inputSelector);Array.from(e).forEach((e=>{e.addEventListener("input",(()=>{this._checkValidity(e),this._validityButton()}))})),this._form.addEventListener("reset",(e=>{this._disableButton()}))}};class s{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close"),this._form=this._popup.querySelector(".popup__form")}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleCloseButton=()=>{this.close()};_handleClickOverlay=e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()};setEventListeners(){this._popup.addEventListener("click",this._handleClickOverlay)}}class n extends s{constructor(e,t){super(e),this._submitFunction=t,this._inputList=this._form.querySelectorAll(".popup__input")}_getInputValues(){return this._values={},this._inputList.forEach((e=>{this._values[e.name]=e.value})),this._values}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction(this._getInputValues()),this.close()}))}close(){super.close(),this._form.reset()}}const r=document.querySelector(".popup_type_profil"),o=document.querySelector(".profile__button-info"),i=r.querySelector(".popup__form_type_profil"),l=document.querySelector(".popup_avatar").querySelector(".popup__form-avatar"),a=document.querySelector(".profile__button"),p=document.querySelector(".popup__form-add"),u={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__submit_add",inputErrorClass:"popup__input_type_error",errorClass:"form__input-error_visible",errorSpan:"form__input-error"},_=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__zoom-image"),this._popupCaption=this._popup.querySelector(".popup__zoom-title")}open=e=>{this._popupImage.src=e.link,this._popupImage.alt=e.title,this._popupCaption.textContent=e.title,super.open()}}(".popup_type_zoom-card"),c=new class{constructor(e){this._inputName=document.querySelector(e.profileNameSelector),this._inputInfo=document.querySelector(e.profileInfoSelector)}getUserInfo(){return{name:this._inputName.textContent,subname:this._inputInfo.textContent}}setUserInfo(e){this._inputName.textContent=e.name,this._inputInfo.textContent=e.subname}}({profileNameSelector:".profile__title",profileInfoSelector:".profile__subtitle"});new t(u,l).enableValidation(),new t(u,i).enableValidation(),new t(u,p).enableValidation(),new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers,this._authorization=e.headers.authorization}getInfo(){return fetch(`${this._url}/users/me`,{headers:{authorization:this._authorization}}).then((e=>e.ok?e.json():Promise.reject))}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-74",headers:{authorization:"66845714-5b02-4496-8606-3df242518ec7","Content-Type":"application/json"}}).getInfo().then((e=>console.log(e)));const h=new class extends s{constructor(e,t){super(e),this._submitFunction=t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction(this._elemint)}))}open=e=>{super.open(),this._elemint=e}}(".popup_delete",(e=>{e.removeCard(),h.close()}));function d(t){return new e(t,".element__template",_.open,h.open).generateCard()}const m=new class{constructor({items:e,renderer:t},s){this._initialArray=e,this._container=document.querySelector(s),this._renderer=t}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{title:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{title:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{title:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{title:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{title:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{title:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{m.addItem(d(e))}},".elements");m.renderItems();const v=new n(".popup_type_profil",(e=>{c.setUserInfo(e)})),f=new n(".popup_add",(e=>{m.addItem(d(e))})),y=new n(".popup_avatar",(e=>{document.querySelector(".profile__avatar").src=e.avatar}));o.addEventListener("click",(()=>(v.open(),void v.setInputValues(c.getUserInfo())))),a.addEventListener("click",(()=>{f.open()})),_.setEventListeners(),v.setEventListeners(),f.setEventListeners(),y.setEventListeners(),h.setEventListeners(),document.querySelector(".profile__button_avatar").addEventListener("click",(()=>{y.open()}))})();